#!/bin/bash

# –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç—ã –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
if [ ! -d .git ]; then
  echo "–û—à–∏–±–∫–∞: —ç—Ç–æ—Ç –∫–∞—Ç–∞–ª–æ–≥ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º."
  exit 1
fi

# –ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–µ—Ç–∫–∏ (–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏)
NEW_BRANCH="main"

echo "–°–æ–∑–¥–∞—é –Ω–æ–≤—É—é –≤–µ—Ç–∫—É –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏..."
git checkout --orphan "$NEW_BRANCH"

echo "–î–æ–±–∞–≤–ª—è—é –≤—Å–µ —Ñ–∞–π–ª—ã –≤ –∏–Ω–¥–µ–∫—Å..."
git add -A

echo "–°–æ–∑–¥–∞—é –∫–æ–º–º–∏—Ç..."
git commit -m "üîÑ –ù–æ–≤—ã–π —Å—Ç–∞—Ä—Ç: –æ—á–∏—â–µ–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞"

echo "–£–¥–∞–ª—è—é —Å—Ç–∞—Ä—É—é –≤–µ—Ç–∫—É..."
git branch | grep -v "$NEW_BRANCH" | xargs git branch -D

echo "–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞—é –≤–µ—Ç–∫—É (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)..."
git branch -m "$NEW_BRANCH"

echo "–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—É—à—É –Ω–∞ GitHub..."
git push -f origin "$NEW_BRANCH"

echo "‚úÖ –ì–æ—Ç–æ–≤–æ: –∏—Å—Ç–æ—Ä–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–∞!"
